Урок 4. Архитектура, устройство и производительность приложений

1. Многозадачность (Picture-in-Picture, разделение экрана)
Многозадачность — это возможность запускать несколько приложений параллельно. 
Ниже — ключевые сценарии многозадачности на iOS и Android, а также нюансы их тестирования.

1.1. Переключение приложений — это базовый сценарий, который присутствует на Android- и iOS-устройствах.
Пользователь уходит из приложения, чтобы ответить на сообщение или открыть браузер, а затем возвращается обратно. 
В упомянутых ранее ОС этот сценарий реализован через кнопку Домой или жесты навигации.

Главная особенность — работа с жизненным циклом приложения. 
В Android при сворачивании могут вызываться методы onPause → onStop, а при нехватке ресурсов 
система может выгрузить приложение из памяти. 
В iOS приложение тоже уходит в фон и может быть «убито», если системе потребуется память.
Код должен обрабатывать такие сценарии без потери данных.
Важно убедиться, что состояние восстанавливается корректно: экран остается тем же, 
ввод сохранен, процесс не прерывается.

1.2. Картинка в картинке (Picture in Picture, PiP)  — один из самых заметных режимов многозадачности, потому что 
приложение продолжает работать даже после сворачивания. 
В этом режиме видео или навигация уменьшаются до небольшого плавающего окна, которое пользователь может 
перемещать поверх других приложений.
Типичные ошибки: остановка воспроизведения при сворачивании, невозможность нажать кнопку Play/Pause или 
потеря позиции при возврате в полноэкранный режим.

1.3. Split View (iPad) / Split-screen (Android) позволяет делить экран между двумя приложениями.
Главная требование к интерфейсу в подобных условиях — адаптивность.
Приложение должно корректно перестраиваться под узкое или широкое окно.
Нужно проверять визуальную корректность, а также сохранение состояния.
Типичные проблемы: неправильная верстка, потеря прокрутки, перекрывающиеся кнопки. 
Распространенный баг —  артефакты при ресайзе, смещения кнопок, или когда приложение сбрасывается или 
полностью перезапускается при переключении между режимами.

Во всех сценариях многозадачности ключевым остается сохранение состояния. Приложение должно «помнить» введенный текст, 
выбранные параметры и текущую позицию. Корректный возврат происходит быстро и бесшовно, не сопровождаясь полной перезагрузкой.
Важно убедиться, что приложение правильно работает в фоновом режиме и корректно восстанавливается после возвращения на экран.

2. Мобильность: датчики (гироскоп, акселерометр), действия (встряхивание)
Мобильность — это способность приложения реагировать на физическое положение и движение устройства. 
Для этого используются встроенные сенсоры: акселерометр, гироскоп, магнитометр (компас), датчик приближения и освещенности. 
Сюда же относится встряхивание или поворот устройства.

2.1. Встряхивание устройства может применяться для обновления экрана, игровых механик или дополнительных действий.
При тестировании важно убедиться, что срабатывание происходит только в тех местах, где это предусмотрено. Например, в проигрывателе
встряхивание вызывает «Следующий трек», но в галерее или текстовом редакторе — не должно вызывать никаких действий. 
Типичные проблемы: случайные срабатывания при ходьбе или поездке в транспорте,потеря данных из-за неожиданного встряхивания,
отсутствие реакции, где пользователь ее ожидает.

2.2. Наклон устройства (акселерометр) фиксирует ускорения по трем осям и используется для распознавания наклонов или шагов.
Во время тестирования важно проверить корректность реакции на наклон, отсутствие «шума» в данных и ложных срабатываний, работу фильтров.
Типичные проблемы: персонаж в игре двигается не туда, куда наклоняет телефон пользователь, шагомер считает шаги, даже если устройство лежит 
на столе.

2.3. Поворот вокруг своей оси (гироскоп) позволяет фиксировать углы вращения и обеспечивает плавность ориентации.
Типичные проблемы: картинка «плавает» даже при неподвижном телефоне, задержка между движением устройства и реакцией интерфейса.

2.4. Компас (магнитометр) фиксирует ориентацию устройства относительно магнитного поля Земли.
Используется в навигации, картах и сервисах, где важна точная ориентация пользователя в пространстве.
Типичные проблемы: резкие скачки ориентации при малейшем движении устройства, стрелка указывает в противоположную сторону.

2.5. Датчик приближения  используется главным в основном во время звонков: когда пользователь подносит телефон к уху, 
экран должен автоматически гаснуть.
Типичные проблемы: экран не гаснет, экран остается выключенным (темным) после завершения звонка, реагирует на малейшую тень.

2.6. Датчик освещенности  регулирует яркость экрана в зависимости от внешних условий.
Во время тестирования важно оценить плавность переходов: система должна реагировать достаточно быстро, но не вызывать
мерцание. 

3. Адаптивность (изменение ориентации экрана) для приложений это означает необходимость гибко перестраиваться под 
новые размеры и ориентацию экрана при повороте.
Система выполняет несколько последовательных действий: меняются размеры экрана, перестраивается интерфейс,  приложение восстанавливает состояние.
Типичные ошибки при повороте девайса:
- текст и кнопки съезжают, элементы перекрывают друг друга
- введенный текст в форме стирается, сбрасываются фильтры
- появляются пустые области, теряется позиция на экране
- приложение крашится при повороте или зависает, если не справляется с пересозданием экрана
- часть интерфейса подстраивается под новую ориентацию, а часть остается в старом состоянии

4. Кэш - — это механизм временного хранения данных, который ускоряет работу приложения и снижает нагрузку на сеть.
Пользователь получает быстрый отклик, а приложение экономит трафик и ресурсы. 
При этом важно помнить, что чрезмерный рост кэша влияет на производительность: замедляет работу и может привести к зависанию
или даже закрытию программы. 
Кэш на Android можно чистить вручную, на iOS нет. 
При проверке важно убедиться, что приложение не хранит лишние данные и корректно очищает кэш в нужный момент.
Важно проверять, как приложение ведет себя при первом запуске, после очистки кэша, при длительном использовании,
при обновлении данных на сервере.

5. Фича-тоглы: управление функциями, отличия от веб-приложений - механизм управления функциональностью приложения без выпуска новой версии. 
С их помощью разработчики могут включать или выключать отдельные функции, тестировать нововведения на ограниченной группе пользователей.
Как работают фича-тоглы в мобильных приложениях: 
При запуске приложение обращается к серверу за конфигурацией и в зависимости от ответа приложение строит интерфейс 
и активирует (или скрывает) набор сценариев. 
Типичная ошибка: возможны рассинхронизации в работе приложения и интерфейса при включенном / отключенном фича-тогле. 
Однако стоит помнить, что мгновенной синхронизации может мешать кэширование, также может потребоваться перезапуск из-за особенностей
архитектуры мобильных приложений. 
Важно тестировать обновление конфигурации при плохом интернете, при переходе в офлайн и после повторного запуска приложения. 
Отдельный сценарий — пользователи с разными версиями ОС. 

6. Потребление батареи и памяти (мониторинг ресурсов) включает:
- проверка объема памяти, который приложение потребляет при запуске, переходе между экранами и длительной работе
- сохранность данных и состояний после выгрузки из памяти системой
- расход батареи при активном использовании
- отсутствии утечек с каждым новым запуском
В iOS память строго контролируется системой. У каждого приложения есть лимит RAM. 
При превышении лимита система просто выгружает процесс — без предупреждений и явных ошибок. 
Android при нехватке ресурсов начнет завершать фоновые процессы. 


 